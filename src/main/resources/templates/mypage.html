<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>User</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://hangeul.pstatic.net/hangeul_static/css/nanum-square.css">
  <style>
    body {
      font-family: 'NanumSquareExtraBold';
    }
  </style>
</head>
<body>

<h2 style="font-size: 2.0rem" class="col mb-5 mt-5 fw-bold text-center">마이페이지</h2>
<!-- 메인 시작 -->
<div class="container my-5" style="transform: rotate(0.04deg)">&nbsp;</div>
<div class="container container-fluid my-5 text-center" style="transform: rotate(0.04deg)">
  <div class="row">
    <div class="col mb-4">
      <img src="/img/person-circle.svg" style="width: 12rem;" alt="person-circle" />
    </div>
  </div>

  <div class="row">
    <div class="col mb-5 fw-bold">
      <a style="font-size:2rem" id="userName" th:text="${username}">&nbsp;</a>
    </div>
  </div>
<div style="transform: rotate(0.04deg)">[[${test}]]</div>
  <div class="row ms-3 me-3" style="transform: rotate(0.04deg)">
    <div class="col-6">
      <button type="button" class="btn btn-secondary btn-lg w-100 fw-bold" style="background-color: #FCA56F; border: none;"
              onclick="location.href='/likelist'">찜한 음식점</button>
    </div>

    <div class="col-6">
      <button type="button" id="modifyBtn" class="btn btn-secondary btn-lg w-100 fw-bold" style="background-color: #FCA56F; border: none" data-bs-toggle="modal" data-bs-target="#staticBackdrop">정보 수정</button>
    </div>


    <div class="col-12 mt-3">
      <button type="button" id="logoutBtn" class="btn btn-secondary btn-lg w-100 fw-bold" style="background-color: #C2C2C2; border: none;" onclick="location.href='/logout'">로그아웃</button>
    </div>
  </div>
</div>
<!-- 메인 끝 -->

<!-- 모달 시작 -->
<div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5 fw-bold" id="staticBackdropLabel">유저 이메일 변경</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body fw-bold">
        <div class="form-floating mb-3">
          <input type="text" class="form-control" name="modalUserName" id="modalUserName" placeholder="아이디를 입력하세요" />
          <label for="modalUserName">이메일 입력</label>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary fw-bold" style="border: none;" data-bs-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary fw-bold" style="background-color: coral; border: none;" data-bs-dismiss="modal" id="saveBtn">저장</button>
      </div>
    </div>
  </div>
</div>
<div id="menuBar"></div>
<script src="/js/menuBar.js"></script>
<!-- 모달 끝 -->
</body>
<script src="/js/fetcher.js"></script>
<script>
  const userName = document.getElementById('userName');
  const modifyBtn = document.getElementById('modifyBtn');
  const saveBtn = document.getElementById('saveBtn');
  const modalUserName = document.getElementById('modalUserName');

  modifyBtn.addEventListener('click', () => {
    modalUserName.value = userName.innerHTML
  })

  saveBtn.addEventListener('click', async () => {
    await fetch('/modify', {
          method: 'post',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({
            userId: modalUserName.value
          })
        });
    userName.innerHTML = modalUserName.value;
  })


</script>
</html>